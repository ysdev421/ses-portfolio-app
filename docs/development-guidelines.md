# 開発ガイドライン（再発防止）

## 目的
- 文字化け
- 日付入力の仕様ブレ
- 日本語/英語表示の揺れ
- 編集時バリデーションエラー

上記を今後起こさないための共通ルールです。

## 1. 文字コードルール
- すべてのソースファイルは `UTF-8`（BOMなし）で保存する。
- エディタの保存エンコーディングを `UTF-8` に固定する。
- 文字化けした状態のテキストをそのままコミットしない。
- 大きめの置換や再生成後は、必ず差分で日本語文字列を目視確認する。

## 2. 日付入力ルール
- 日付入力UIは `type="date"` を標準とする（テキスト入力へ戻さない）。
- 日付入力には `lang="ja"` を付与する。
- 保存フォーマットは `YYYY-MM-DD` に統一する。
- フォーム初期化時は `string | Date | Firestore Timestamp` を `YYYY-MM-DD` に正規化してから state に入れる。
- バリデーションは `normalizeDateString` を必ず通す。

## 3. ロケール/表示ルール
- `public/index.html` の `<html lang>` は `ja` を維持する。
- 日本語UIの文言は英語と混在させない（意図がある場合のみ例外）。
- `toLocaleDateString` / `toLocaleString` は原則 `ja-JP` を指定する。

## 4. 実装パターン（必須）
- 日付変換ロジックは `src/utils/date.js` を使い回す。
- 同じ処理を複数コンポーネントにコピペしない。
- 画面の責務を分離する（例: キャリアシート と 選考管理）。

## 5. 変更前後チェック（PR前）
- `npm run build` が成功すること。
- 該当画面を手で確認すること。
- 日付入力:
  - カレンダーUIで選択できる
  - 編集画面で既存値が表示される
  - 更新時に日付バリデーションエラーが出ない
- 文言:
  - タイトル/ラベルが日本語で統一されている
  - 文字化けがない

## 6. 触ってはいけないこと
- 日付入力を安易に `type="text"` に戻さない。
- コンポーネントごとに独自の日付パーサを増やさない。
- 壊れた日本語文字列を「そのまま」修正対象外で放置しない。

## 7. 変更時テンプレ（PR説明）
- 目的:
- 変更ファイル:
- 仕様影響:
- 確認項目（build / 画面動作 / 日付編集）:
- 既知の制約:

